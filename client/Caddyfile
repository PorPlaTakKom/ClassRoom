{
  email {$ACME_EMAIL}
}

{$DOMAIN:localhost} {

  encode gzip

  # LiveKit signaling + WebSocket + metrics
  @livekit path /rtc /rtc/* /twirp/* /livekit-metrics
  handle @livekit {
    reverse_proxy livekit:7880
  }

  # Backend API + Socket.IO
  @api path /api/* /socket.io/* /metrics
  handle @api {
    reverse_proxy server:4000
  }

  # Frontend (React build)
  handle {
    root * /srv
    try_files {path} /index.html
    file_server
  }
}
